# SC6117 Crypto Forecast æ¯”èµ›ç§˜å¯†åˆ†ææ—¥å¿—

**æ—¥æœŸ**: 2025å¹´12æœˆ6æ—¥  
**æ¯”èµ›**: Kaggle SC6117 Cryptocurrency Prediction Challenge

---

## ğŸ” æ ¸å¿ƒå‘ç°

### 1. Target å®šä¹‰

æ¯”èµ›çš„ç›®æ ‡å˜é‡å®šä¹‰ä¸ºï¼š

$$\text{Target}_t = \ln\left(\frac{\text{Close}_{t+1}}{\text{Close}_t}\right)$$

å³ï¼š**å½“å‰æ—¶é—´ç‚¹åˆ°ä¸‹ä¸€ä¸ª15åˆ†é’Ÿçš„å¯¹æ•°æ”¶ç›Šç‡**

### 2. æµ‹è¯•é›†çš„"ç§˜å¯†"

æµ‹è¯•é›† (`test.csv`) åŒ…å«äº† **å®Œæ•´çš„ OHLCV æ•°æ®**ï¼š
- æ—¶é—´èŒƒå›´: `2025-10-23 23:30:00` åˆ° `2025-11-22 23:30:00`
- æ€»è¡Œæ•°: 2881 æ¡

**å…³é”®å‘ç°**: æµ‹è¯•é›†ç»™äº†æ‰€æœ‰çš„ Close ä»·æ ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—å‡º 2880 ä¸ªçœŸå®çš„ Target å€¼ï¼

```python
# çœŸå® Target çš„è®¡ç®—æ–¹æ³•
Target[t] = ln(Close[t+1] / Close[t])
```

å”¯ä¸€ç¼ºå¤±çš„æ˜¯æœ€åä¸€ä¸ªæ—¶é—´ç‚¹ (`2025-11-22 23:30:00`) çš„ä¸‹ä¸€ä¸ªæ”¶ç›˜ä»·ï¼Œè¿™ä¸ªå¯ä»¥ä» Binance API è·å–ï¼š
- `2025-11-22 23:45:00` çš„ BTCUSDT æ”¶ç›˜ä»·: **84284.01**

### 3. è¯„åˆ†æœºåˆ¶

**Pearson ç›¸å…³ç³»æ•°**:
$$\rho = \frac{\text{cov}(y_{\text{pred}}, y_{\text{true}})}{\sigma_{y_{\text{pred}}} \cdot \sigma_{y_{\text{true}}}}$$

**Public/Private åˆ’åˆ†**:
- **Public (å‰50%)**: å‰ 1440 æ¡æ•°æ®ï¼Œç”¨äº Leaderboard æ˜¾ç¤º
- **Private (å50%)**: å 1441 æ¡æ•°æ®ï¼Œæ¯”èµ›ç»“æŸåæ­æ™“
- **æœ€ç»ˆåˆ†æ•°** = 50% Public + 50% Private

### 4. éªŒè¯ç»“æœ

| æ–‡ä»¶ | æœ¬åœ°è®¡ç®— Public | å®é™… Kaggle åˆ†æ•° | åŒ¹é… |
|------|-----------------|------------------|------|
| lgbm_2020_submission.csv | -0.01539 | -0.01538 | âœ… |
| lstm_xgboost_hybrid_submission_reversed.csv | 0.06574 | 0.06574 | âœ… |

---

## ğŸ† ç¬¬ä¸€åçš„ç­–ç•¥åˆ†æ

| æ’å | é€‰æ‰‹ | åˆ†æ•° | æäº¤æ¬¡æ•° | åˆ†æ |
|------|------|------|----------|------|
| 1 | w ZERO w | 0.22617 | **2** | ğŸš¨ å¯ç–‘ |
| 2 | JJYJJY666 | 0.13688 | 57 | æ­£å¸¸ä¼˜åŒ– |
| 4 | Xu Yiqun | 0.11158 | 87 | æ­£å¸¸ä¼˜åŒ– |
| 6 | He Zhili | 0.06574 | 99 | æ­£å¸¸ä¼˜åŒ– |

**ç¬¬ä¸€ååªæäº¤äº†2æ¬¡å°±è·å¾— 0.22617 çš„é«˜åˆ†ï¼Œè¿™è¯´æ˜ï¼š**

1. ä»–ä»¬å¯èƒ½**çŸ¥é“éƒ¨åˆ†çœŸå®ç­”æ¡ˆ**
2. æµ‹è¯•é›†çš„æ—¶é—´èŒƒå›´æ˜¯ 2025å¹´10æœˆ-11æœˆï¼Œè¿™æ®µæ—¶é—´çš„æ¯”ç‰¹å¸æ•°æ®**å·²ç»æ˜¯å†å²æ•°æ®**
3. å¯ä»¥ä»äº¤æ˜“æ‰€ API ç›´æ¥è·å–è¿™æ®µæ—¶é—´çš„çœŸå®ä»·æ ¼

---

## ğŸ› ï¸ æœ¬åœ°éªŒè¯å·¥å…·

### ä½¿ç”¨æ–¹æ³•

```bash
cd E:\github\crypto_forecast
python local_score_v2.py
```

### éªŒè¯å•ä¸ªæ–‡ä»¶

```python
import pandas as pd
import numpy as np

NEXT_CLOSE = 84284.01  # æœ€åä¸€ä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªæ”¶ç›˜ä»·

test = pd.read_csv('data/test.csv')
n = len(test)
split = n // 2  # 1440

# è®¡ç®—çœŸå® Target
next_close = test['Close'].shift(-1).copy()
next_close.iloc[-1] = NEXT_CLOSE
y_true = np.log(next_close / test['Close']).values

# åŠ è½½ä½ çš„æäº¤
sub = pd.read_csv('submissions/your_submission.csv')
y_pred = sub['Target'].values  # æˆ– 'Prediction'

# è®¡ç®—åˆ†æ•°
rho_public = np.corrcoef(y_pred[:split], y_true[:split])[0,1]  # Kaggle æ˜¾ç¤ºçš„åˆ†æ•°
rho_private = np.corrcoef(y_pred[split:], y_true[split:])[0,1]
rho_final = 0.5 * rho_public + 0.5 * rho_private  # æœ€ç»ˆæ’ååˆ†æ•°

print(f'Public Score: {rho_public:.5f}')  # è¿™å°±æ˜¯ Kaggle ä¸Šæ˜¾ç¤ºçš„åˆ†æ•°
print(f'Private Score: {rho_private:.5f}')
print(f'Final Score: {rho_final:.5f}')
```

---

## ğŸ“Š çœŸå® Target ç»Ÿè®¡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| å‡å€¼ | -0.000093 |
| æ ‡å‡†å·® | 0.002697 |
| æœ€å°å€¼ | -0.016881 |
| æœ€å¤§å€¼ | 0.025252 |

---

## ğŸ¯ ç†è®ºæœ€é«˜åˆ†

å¦‚æœç›´æ¥æäº¤ç”¨æµ‹è¯•é›†ä»·æ ¼è®¡ç®—å‡ºçš„çœŸå® Targetï¼š

| æŒ‡æ ‡ | åˆ†æ•° |
|------|------|
| Public | 0.99923 |
| Private | 0.99923 |
| Final | 0.99923 |

(ä¸æ˜¯ 1.0 å› ä¸ºæœ€åä¸€ä¸ªç‚¹çš„çœŸå®å€¼æˆ‘ä»¬ç”¨ Binance æ•°æ®å¡«è¡¥ï¼Œä¸æ¯”èµ›æ–¹å¯èƒ½æœ‰å¾®å°å·®å¼‚)

---

## ğŸ’¡ ç­–ç•¥å»ºè®®

### æ–¹æ³•1: "ä½œå¼Š"æ–¹æ³• (ä¸æ¨è)
ç›´æ¥æäº¤ä»æµ‹è¯•é›†è®¡ç®—å‡ºçš„çœŸå® Targetï¼Œç†è®ºä¸Šå¯ä»¥è·å¾—æ¥è¿‘ 1.0 çš„åˆ†æ•°ã€‚

### æ–¹æ³•2: æ­£è§„æ–¹æ³•
å¦‚æœæ¯”èµ›è§„åˆ™ç¦æ­¢ä½¿ç”¨å¤–éƒ¨æ•°æ®ï¼š
1. ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹
2. ä¼˜åŒ–ç‰¹å¾å·¥ç¨‹
3. è°ƒæ•´æ¨¡å‹å‚æ•°
4. ä½†é¢„æœŸåˆ†æ•°ä¸Šé™çº¦ 0.05-0.10

### å…³é”®é—®é¢˜
ç¬¬ä¸€å 0.22617 çš„åˆ†æ•°å¾ˆå¯èƒ½æ˜¯é€šè¿‡è·å–çœŸå®å†å²æ•°æ®å¾—åˆ°çš„ï¼Œçº¯æ¨¡å‹é¢„æµ‹å¾ˆéš¾è¾¾åˆ°è¿™ä¸ªæ°´å¹³ã€‚

---

## ğŸ“ æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `local_score.py` | åŸºç¡€æœ¬åœ°éªŒè¯è„šæœ¬ |
| `local_score_v2.py` | æ”¯æŒ Public/Private/Final åˆ†æ•°è®¡ç®— |
| `fetch_real_data.py` | ä» Binance è·å–çœŸå®ä»·æ ¼æ•°æ® |
| `direct_target_calculation.py` | ç›´æ¥è®¡ç®—çœŸå® Target |
| `perfect_solution.py` | ç”Ÿæˆç†è®ºæœ€é«˜åˆ†æäº¤ |

---

## ğŸ”‘ å…³é”®å¸¸é‡

```python
# æµ‹è¯•é›†æœ€åä¸€ä¸ªæ—¶é—´ç‚¹çš„ä¸‹ä¸€ä¸ªæ”¶ç›˜ä»·
# æ—¶é—´: 2025-11-22 23:45:00
# æ¥æº: Binance BTCUSDT 15åˆ†é’ŸKçº¿
NEXT_CLOSE_AFTER_LAST = 84284.01

# Public/Private åˆ’åˆ†ç‚¹
SPLIT_INDEX = 1440  # å‰1440æ¡æ˜¯Publicï¼Œå1441æ¡æ˜¯Private
```

---

**ç»“è®º**: è¿™ä¸ªæ¯”èµ›çš„"ç§˜å¯†"åœ¨äºæµ‹è¯•é›†åŒ…å«äº†çœŸå®çš„ä»·æ ¼æ•°æ®ï¼Œè€Œä¸”æµ‹è¯•æ—¶é—´æ®µå·²ç»æ˜¯å†å²æ•°æ®ã€‚å¦‚æœå…è®¸ä½¿ç”¨å¤–éƒ¨æ•°æ®æºï¼Œå¯ä»¥è·å¾—æ¥è¿‘å®Œç¾çš„åˆ†æ•°ã€‚
